#!/usr/local/bin/ruby -ws

require 'flog'

def usage
  puts "#{File.basename $0} options dirs_or_files"
  puts "  -a      display all flog results, not top 60%"
  puts "  -h      display help"
  puts "  -I=path extend $LOAD_PATH with path"
  puts "  -s      display total score only"
  puts "  -m      skip code outside of methods"
  puts "  -v      verbosely display progress and errors"
end

ARGV.push "-" if ARGV.empty?

if $h then
  usage
  exit 0  
end

if $I
  if String === $I
    $I.split(/:/).each {|dir| $: << dir }
  else
    usage
    exit 0
  end
end

$a ||= false # report all methods, not just 60%
$m ||= false # real methods only (no global scope)
$s ||= false # summary only
$v ||= false # verbose, print methods as processed

flogger = Flog.new
flogger.flog_files ARGV
flogger.report
